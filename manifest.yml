---
version: 1
applications:
  - name: gitlab-runner
    path: runner
    buildpacks:
      - https://github.com/cloudfoundry/apt-buildpack
      - binary_buildpack
    no-route: true
    health-check-type: process
    instances: 1
    memory: ((runner_memory))
    command: gitlab-runner run
    services:
      - ((service_account_instance))
    env:
      CI_SERVER_URL: ((ci_server_url))
      RUNNER_NAME: ((runner_name))
      AUTHENTICATION_TOKEN: ((authentication_token))
      DEFAULT_JOB_IMAGE: ((default_job_image))
#   Turning this down - Will try having executor launch new instances
#   - name: gitlab-worker
#     docker:
#       image: ubuntu:latest
#     no-route: true
#     health-check-type: process
#     instances: 0
#     memory: ((worker-memory))
# 
